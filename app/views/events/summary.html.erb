<h2 class="text-red text-space-around"><%= @event.title %> Overview</h2>
  <div id="summary-bar">
    <div class="card-square">
      <h2><%= @event.audiences.count %></h2>
      <p>people attended!</p>
    </div>
    <div class="card-square">
      <h2><%= @event.messages.count %></h2>
      <p>comments received!</p>
    </div>
    <div class="card-square">
      <h2><%= @event.questions.count %></h2>
      <p>questions received!</p>
    </div>
    <div class="card-square">
      <h2><%= @event.questions.count %></h2>
      <p>polls created!</p>
    </div>
    <div class="card-square">
      <h2><%= @event.questions.count %></h2>
      <p>pieces of feedback received!</p>
    </div>
  </div>
<h3 class="text-red text-space-around">Facilitation details</h3>
<div class="summary-cards-first">
  <div class="card-box">
    <h3>Popular comments</h3>
    <div class="audience-card">
      <%= image_tag "avatar.svg", class: "avatar" %>
      <p>Most liked message</p>
    </div>
    <p class="right">See all messages</p>
    <h3>Popular questions</h3>
    <div class="audience-card">
      <%= image_tag "avatar.svg", class: "avatar" %>
      <p>Most liked question</p>
    </div>
    <p class="right">See all questions</p>
  </div>
  <div class="card-box-wide">
    <h4 class="center">Poll results</h4>
    <div class="poll-result">
      <p>poll 1</p>
    </div>
    <div class="poll-result">
      <p>poll 2</p>
    </div>
    <div class="poll-result">
      <p>poll 3</p>
    </div>
    <div class="poll-result">
      <p>poll 4</p>
    </div>
    <p class="right">See all results</p>
  </div>
  <div class="card-box">
    <h4 class="center">Feedback</h4>
    <div class="feedback">
      <p>feedback 1</p>
    </div>
    <div class="feedback">
      <p>feedback 2</p>
    </div>
    <div class="feedback">
      <p>feedback 3</p>
    </div>
    <p>Event rating</p>
    <p class="right">See all feedback</p>
  </div>
</div>

<h3 class="text-red text-space-around">Audience details</h3>
<div class="summary-cards">
  <div class="card-box">
    <div id="audience-list">
       <h3><%= @event.audiences.count %> <small>attendees</small></h3>
       <p>See all</p>
    </div>
      <% @event.users.first(4).each do |audience| %>
        <div class="audience-card">
          <div>
            <% if audience.photo.attached? %>
              <%= cl_image_tag audience.photo.key, class: "avatar" %>
            <% else %>
               <%= image_tag "avatar.svg", class: "avatar" %>
            <% end %>
          </div>
           <div class="audience-name-card">
             <h6><%= audience.first_name %> <%= audience.last_name %></h6>
          </div>
        </div>
      <% end %>
  </div>
  <div class="card-box">
     <h4 class="center">Audience age</h4>
     <%= bar_chart @event.users.group("FLOOR(age / 10) * 10").count, width: "240px", height: "240px", colors: ['#800000']%>
  </div>
  <div class="card-box">
    <h4 class="center">Gender breakdown</h4>
    <%= pie_chart @event.users.group(:gender).count, width: "240px", height: "240px", colors: ['#800000', '#001980'] %>
    <div class="d-flex justify-content-around m-3">
      <% females = @event.users.select do |user| %>
        <% user.gender == "Female"  %>
      <% end %>
      <% unless females == nil && females.empty? %>
        <p>Female <%= ((females.count.to_f / @event.users.count) * 100).round %>%</p>
        <% males = @event.users.select do |user| %>
          <% user.gender == "Male"  %>
        <% end %>
      <% end %>
      <% unless  males == nil && males.empty? %>
        <p>Male <%= ((males.count.to_f / @event.users.count) * 100).round %>%</p>
      <% end %>
    </div>
  </div>
  <div class="card-box">
    <h5 class="center">Audience occupation breakdown</h5>
    <div class="d-flex justify-content-around">
      <%= pie_chart @event.users.group(:occupation).count, donut: true, id: "users-chart", height: "300px", width: "320px", colors: ['#001980', '#800000', '#D78C00', '#357544', '#75355D', '#FF8C9E'] %>
    </div>
  </div>
</div>

<%= render 'compare_summary', event: @event, audiences: @audiences, messages: @messages, questions: @questions %>








